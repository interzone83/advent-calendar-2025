<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Melville's Musical Advent Calendar 2025</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
* { box-sizing: border-box; }

:root { --door-gap: 4%; }

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: url("tree.jpg") center center / cover no-repeat fixed;
  color: #fff;
  text-align: center;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
  position: relative;
}

#snow-back, #snow-mid, #snow-front {
  position: fixed;
  inset: 0;
  pointer-events: none;
}
#snow-back { z-index: 1; }
#snow-mid { z-index: 2; }
#snow-front { z-index: 3; }

h1 {
  margin: 0.5rem 0 0.15rem;
  font-size: clamp(1.6rem, 3vw, 2.3rem);
  z-index: 10;
}

.subtitle {
  margin: 0 0 0.5rem;
  font-size: 0.9rem;
  opacity: 0.9;
  z-index: 10;
}

/* Calendar */
.calendar-wrapper {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  flex: 1;
  z-index: 10;
}

.calendar-box {
  width: min(95vw, 75vh);
  height: min(95vw, 75vh);
  perspective: 1200px;
}

.calendar {
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.25);
  border-radius: 18px;
  padding: var(--door-gap);
  display: grid;
  grid-template-columns: repeat(5,1fr);
  grid-template-rows: repeat(5,1fr);
  gap: var(--door-gap);
}

.door {
  background: rgba(200,0,0,0.9);
  border-radius: 12px;
  border: 2px solid gold;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-weight: 700;
  font-size: clamp(16px,2.4vw,22px);
  position: relative;
  overflow: hidden;
  transition: 0.2s ease;
}

.door:hover { transform: scale(1.03); }

.door.open {
  background: rgba(0,90,0,0.95);
}

.door-number {
  z-index: 2;
  transition: opacity 0.2s;
}

.door.open .door-number { opacity: 0; }

.door-image {
  position: absolute;
  inset: 4px;
  width: calc(100% - 8px);
  height: calc(100% - 8px);
  object-fit: cover;
  border-radius: 8px;
  opacity: 0;
  transition: opacity 0.25s;
}

.door.open .door-image { opacity: 1; }

/* Image modal */
#img-modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  justify-content: center;
  align-items: center;
  z-index: 30000;
  cursor: pointer;
}

#img-modal.open { display: flex; }

#img-modal-content {
  width: 95vw;
  height: 95vh;
  object-fit: contain;
  border-radius: 16px;
}

/* Christmas message */
#christmas-message {
  position: fixed;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: clamp(2.5rem,5vw,4rem);
  font-weight: bold;
  color: gold;
  background: rgba(0,0,0,0.7);
  opacity: 0;
  pointer-events: none;
  z-index: 25000;
  transition: opacity 0.4s;
}

#christmas-message.show {
  opacity: 1;
  pointer-events: auto;
}

/* NOW PLAYING BAR */
#now-playing {
  position: fixed;
  bottom: 1.5rem;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.7);
  border-radius: 12px;
  padding: 0.6rem 1rem;
  width: min(90vw, 420px);
  color: gold;
  font-size: 0.95rem;
  opacity: 0;
  transition: opacity 0.3s;
  z-index: 26000;
}

#now-playing.show { opacity: 1; }

#now-playing-title {
  margin-bottom: 6px;
}

#progress-bar {
  width: 100%;
  height: 6px;
  background: rgba(255,255,255,0.25);
  border-radius: 6px;
  overflow: hidden;
}

#progress-fill {
  height: 100%;
  width: 0%;
  background: gold;
}
</style>
</head>

<body>

<div id="snow-back"></div>
<div id="snow-mid"></div>
<div id="snow-front"></div>

<div id="christmas-message">ðŸŽ„ Merry Christmas Melville! ðŸŽ„</div>

<div id="img-modal">
  <img id="img-modal-content">
</div>

<div id="now-playing">
  <div id="now-playing-title"></div>
  <div id="progress-bar">
    <div id="progress-fill"></div>
  </div>
</div>

<h1>Melville's Musical Advent Calendar 2025</h1>
<p class="subtitle">Click a door to reveal its picture and play its song.</p>

<div class="calendar-wrapper">
  <div class="calendar-box">
    <div class="calendar" id="calendar"></div>
  </div>
</div>

<script>
/* Song info */
const songInfo = {
  1:"Let's Dance â€“ David Bowie",
  2:"Petit garÃ§on â€“ Graeme Allwright",
  3:"Merry Christmas Everyone â€“ Shakin' Stevens",
  4:"Alana â€“ Wes",
  5:"RÃ©siste â€“ France Gall",
  6:"Flocon Papillon â€“ Anne Sylvestre",
  7:"Jingle Bells â€“ Frank Sinatra",
  8:"Soda Pop â€“ K-Pop Demon Hunters",
  9:"Jazz Fart â€“ Mr Jazz",
  10:"Song Title 10",
  11:"Twinkle Twinkle Little Star",
  12:"Nothing From Nothing â€“ Billy Preston",
  13:"I Won't Let You Down â€“ OK Go",
  14:"Grand Old Duke of York",
  15:"Petit Papa NoÃ«l",
  16:"Defying Gravity â€“ Wicked",
  17:"Wheels on the Bus (Dance)",
  18:"Sir Duke â€“ Stevie Wonder",
  19:"House of Bamboo â€“ Andy Williams",
  20:"Ce Qu'on Te Donne â€“ Huntrix",
  21:"You Can't Always Get What You Want â€“ Rolling Stones",
  22:"No Woman No Cry â€“ Bob Marley",
  23:"APT â€“ RosÃ© & Bruno Mars",
  24:"I Like To Move It â€“ Reel 2 Real",
  25:"Special Christmas Song"
};

/* Audio */
const audios = {};
let currentAudio = null;
let progressTimer = null;

function stopCurrentAudio() {
  if (currentAudio) {
    currentAudio.pause();
    currentAudio.currentTime = 0;
    currentAudio = null;
  }
  clearInterval(progressTimer);
  document.getElementById("now-playing").classList.remove("show");
}

/* Progress bar */
function startProgress(audio) {
  const fill = document.getElementById("progress-fill");
  clearInterval(progressTimer);
  progressTimer = setInterval(() => {
    if (!audio.duration) return;
    fill.style.width = (audio.currentTime / audio.duration) * 100 + "%";
  }, 300);

  audio.onended = () => {
    clearInterval(progressTimer);
    document.getElementById("now-playing").classList.remove("show");
  };
}

/* Calendar */
const calendar = document.getElementById("calendar");
const now = new Date();
const today = now.getDate();
const isDecember = now.getMonth() === 11;

for (let n = 1; n <= 25; n++) {
  const door = document.createElement("div");
  door.className = "door";
  door.innerHTML = `<div class="door-number">${n}</div><img class="door-image" src="images/${n}.png">`;

  door.addEventListener("click", () => {
    if (!isDecember || n > today) {
      alert(`Door ${n} opens on December ${n}`);
      return;
    }

    door.classList.add("open");

    if (!audios[n]) {
      audios[n] = new Audio(`music/${n}.mp3`);
    }

    stopCurrentAudio();
    currentAudio = audios[n];
    currentAudio.play();

    document.getElementById("now-playing-title").textContent =
      "ðŸŽµ " + (songInfo[n] || `Door ${n}`);
    document.getElementById("now-playing").classList.add("show");

    startProgress(currentAudio);

    if (n === 25) {
      const msg = document.getElementById("christmas-message");
      msg.classList.add("show");
      setTimeout(() => msg.classList.remove("show"), 10000);
    }

    const modal = document.getElementById("img-modal");
    document.getElementById("img-modal-content").src = `images/${n}.png`;
    modal.classList.add("open");
  });

  calendar.appendChild(door);
}

document.getElementById("img-modal").addEventListener("click", () => {
  document.getElementById("img-modal").classList.remove("open");
});
</script>

</body>
</html>
